I. Netfilter
Apply rules on IP address
II. Netlink 
User space app use for communication with firewall

Build and run
make
sudo insmod firewall.ko
./firewall-cli --help